{
  "buffer_overflow": {
    "c_pattern": "strcpy, strcat, sprintf \u2192 buffer overflow",
    "python_equiv": "String concatenation without bounds checking, array index out of range",
    "javascript_equiv": "Array access beyond length, buffer operations",
    "example_python": "def process_data(data, index):\n    # Vulnerable: No bounds check\n    result = data[index]  # Can exceed array bounds\n    return result",
    "example_javascript": "function processData(data, index) {\n    // Vulnerable: No length validation\n    return data[index];  // Can access beyond array\n}"
  },
  "use_after_free": {
    "c_pattern": "Using pointer after free()",
    "python_equiv": "Using reference after deletion, accessing closed resources",
    "javascript_equiv": "Using object after deletion, accessing disposed resources",
    "example_python": "def process_resource(resource):\n    del resource\n    # Vulnerable: Use after delete\n    data = resource.read()  # Reference after deletion\n    return data",
    "example_javascript": "function processResource(resource) {\n    delete resource;\n    // Vulnerable: Use after delete\n    return resource.getData();\n}"
  },
  "null_deref": {
    "c_pattern": "NULL pointer dereference",
    "python_equiv": "None access without check, AttributeError",
    "javascript_equiv": "null/undefined access, TypeError",
    "example_python": "def get_user_data(user_id):\n    user = get_user(user_id)\n    # Vulnerable: No None check\n    return user.email  # Can be None",
    "example_javascript": "function getUserData(userId) {\n    const user = getUser(userId);\n    // Vulnerable: No null check\n    return user.email;  // Can be null\n}"
  },
  "command_injection": {
    "c_pattern": "system(), exec() with user input",
    "python_equiv": "os.system(), subprocess without sanitization",
    "javascript_equiv": "child_process.exec() with user input",
    "example_python": "def execute_command(filename):\n    # Vulnerable: Direct user input to command\n    os.system(f\"cat {filename}\")",
    "example_javascript": "function executeCommand(filename) {\n    // Vulnerable: No input validation\n    exec(`cat ${filename}`);\n}"
  },
  "path_traversal": {
    "c_pattern": "fopen() with unsanitized path",
    "python_equiv": "open() without path validation",
    "javascript_equiv": "fs.readFile() with user path",
    "example_python": "def read_file(filepath):\n    # Vulnerable: Path traversal (../../etc/passwd)\n    with open(filepath) as f:\n        return f.read()",
    "example_javascript": "function readFile(filepath) {\n    // Vulnerable: No path sanitization\n    return fs.readFileSync(filepath, 'utf8');\n}"
  },
  "format_string": {
    "c_pattern": "printf(user_input)",
    "python_equiv": "eval(), exec() with user input",
    "javascript_equiv": "eval() with user input",
    "example_python": "def execute_code(code):\n    # Vulnerable: Code injection\n    eval(code)",
    "example_javascript": "function executeCode(code) {\n    // Vulnerable: Code execution\n    eval(code);\n}"
  },
  "integer_overflow": {
    "c_pattern": "Arithmetic without overflow check",
    "python_equiv": "Large number operations, array size calculations",
    "javascript_equiv": "Number overflow in calculations",
    "example_python": "def allocate_buffer(size, count):\n    # Vulnerable: Integer overflow\n    total = size * count  # Can overflow\n    buffer = [0] * total\n    return buffer",
    "example_javascript": "function allocateBuffer(size, count) {\n    // Vulnerable: Overflow in multiplication\n    const total = size * count;\n    return new Array(total);\n}"
  },
  "sql_injection": {
    "c_pattern": "SQL query string concatenation",
    "python_equiv": "String formatting in SQL queries",
    "javascript_equiv": "Template literals in SQL",
    "example_python": "def get_user(username):\n    # Vulnerable: SQL injection\n    query = f\"SELECT * FROM users WHERE name = '{username}'\"\n    return db.execute(query)",
    "example_javascript": "function getUser(username) {\n    // Vulnerable: SQL injection\n    const query = `SELECT * FROM users WHERE name = '${username}'`;\n    return db.query(query);\n}"
  },
  "xss": {
    "c_pattern": "Unescaped HTML output",
    "python_equiv": "render_template without escaping",
    "javascript_equiv": "innerHTML with user data",
    "example_python": "def render_comment(comment):\n    # Vulnerable: XSS\n    html = f\"<div>{comment}</div>\"\n    return html",
    "example_javascript": "function renderComment(comment) {\n    // Vulnerable: XSS\n    element.innerHTML = comment;\n}"
  },
  "deserialization": {
    "c_pattern": "Deserializing untrusted data",
    "python_equiv": "pickle.loads() on user data",
    "javascript_equiv": "JSON.parse() without validation",
    "example_python": "def load_data(data):\n    # Vulnerable: Unsafe deserialization\n    obj = pickle.loads(data)\n    return obj",
    "example_javascript": "function loadData(data) {\n    // Vulnerable: No validation\n    return JSON.parse(data);\n}"
  }
}